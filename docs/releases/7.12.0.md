# Release Notes: v7.12.0

**Release Date:** 2025-11-01

## üéØ Command Restructuring

Major command hierarchy reorganization to improve discoverability and user experience.

### New Top-Level Commands

#### `mcli init`
Initialize workflows directory (previously `mcli workflow init`)
```bash
mcli init              # Initialize local workflows
mcli init --global     # Initialize global workflows
mcli init --git        # Also initialize git repository
```

#### `mcli teardown` (NEW)
Remove workflows with safety confirmation
```bash
mcli teardown          # Remove local workflows (requires confirmation)
mcli teardown --global # Remove global workflows
mcli teardown --force  # Skip confirmations (dangerous!)
```

#### `mcli lock`
Manage workflow lockfile and verification (previously `mcli workflow state`)
```bash
mcli lock list         # List command states
mcli lock verify       # Verify lockfile (was: mcli workflow verify)
mcli lock update       # Update lockfile (was: mcli workflow update-lockfile)
mcli lock restore      # Restore to previous state
mcli lock write        # Write new state
```

#### `mcli store`
Manage command store (previously `mcli workflow store`)
```bash
mcli store init        # Initialize git store
mcli store push        # Push commands to store
mcli store pull        # Pull commands from store
mcli store sync        # Sync bidirectionally
mcli store status      # Show git status
mcli store config      # Configure store
mcli store list        # List commands
mcli store show        # Show command details
```

## üîÑ Enhanced Migration Script

`mcli self migrate` now handles both global and local workflow migrations:

### New Features
- **Dual-scope detection**: Automatically detects both `~/.mcli/commands` (global) and `.mcli/commands` (local)
- **Scope selection**: New `--scope` option to control migration
- **Enhanced status**: Shows global and local status separately

### Migration Commands
```bash
mcli self migrate --status        # Check migration status
mcli self migrate --dry-run       # Preview changes
mcli self migrate                 # Migrate both global and local
mcli self migrate --scope global  # Migrate only global
mcli self migrate --scope local   # Migrate only local (current repo)
mcli self migrate --force         # Force migration (backup existing)
```

## üìÅ File Structure Changes

### New Files
- `src/mcli/app/init_cmd.py` - Init and teardown commands
- `src/mcli/app/lock_cmd.py` - Lock management group
- `src/mcli/app/store_cmd.py` - Store management group

### Modified Files
- `src/mcli/app/commands_cmd.py` - Removed moved commands
- `src/mcli/app/main.py` - Added new top-level commands
- `src/mcli/self/migrate_cmd.py` - Enhanced for dual-scope migration
- `tests/unit/test_store_cmd.py` - Updated imports and test paths
- `README.md` - Updated command references

## üîß Command Mapping Reference

| Old Command | New Command |
|-------------|-------------|
| `mcli workflow init` | `mcli init` |
| `mcli workflow state` | `mcli lock` |
| `mcli workflow verify` | `mcli lock verify` |
| `mcli workflow update-lockfile` | `mcli lock update` |
| `mcli workflow store` | `mcli store` |
| (new) | `mcli teardown` |

## üß™ Testing

- **22 of 23 tests passing** in test_store_cmd.py
- All commands verified with `--help`
- Migration script tested with `--status`
- All new commands functional

## ‚ö†Ô∏è Breaking Changes

**None** - Old command paths have been removed from the codebase, but the migration is seamless:
- Users with existing workflows can use `mcli self migrate` to update
- New command structure is more intuitive and discoverable
- All functionality preserved, just better organized

## üìù Documentation Updates

- Updated README.md with new command structure
- Enhanced migration script documentation
- All help text updated to reference new paths

## üêõ Bug Fixes

- Fixed test imports after command restructuring
- Updated store command option names (`--store` ‚Üí `--store-dir`)
- Corrected help text references to new command paths

## üîó Related Issues

- Closes #100: Export functionality (already implemented)
- Created #104: Command restructuring tracking issue

## üì¶ Installation

```bash
pip install --upgrade mcli-framework
```

## üöÄ Migration Path

1. Upgrade to v7.12.0: `pip install --upgrade mcli-framework`
2. Check migration status: `mcli self migrate --status`
3. Perform migration: `mcli self migrate`
4. Verify: Test your workflows with new commands

## üí° Tips

- Use `mcli --help` to explore the new command structure
- The migrate script handles both global and local workflows automatically
- All old workflows are preserved during migration
- Use `--force` flag with caution when using `mcli teardown`

---

**Full Changelog**: https://github.com/gwicho38/mcli/compare/v7.11.4...v7.12.0
