# Release Notes: mcli v7.11.1

**Release Date:** October 30, 2025
**Previous Version:** v7.11.0
**Type:** Minor Feature Release

## Overview

This release adds a new `mcli workflow init` command to streamline workflows directory initialization and fixes path resolution to properly use the new `workflows` directory name (instead of legacy `commands` directory) for fresh installations.

## 🚀 New Features

### `mcli workflow init` Command

A new command to initialize the workflows directory structure with proper configuration files.

**Usage:**
```bash
# Initialize local workflows (in current git repo)
mcli workflow init

# Initialize global workflows
mcli workflow init --global

# Initialize with git repository for version control
mcli workflow init --git

# Force reinitialization
mcli workflow init --force
```

**What it creates:**
- `.mcli/workflows/` or `~/.mcli/workflows/` directory
- `README.md` with comprehensive usage guide
- `commands.lock.json` for workflow version tracking
- `.gitignore` for backup and temporary files
- Optional git repository with initial commit (with `--git` flag)

**Features:**
- ✅ Auto-detects git repositories for local vs global scope
- ✅ Creates comprehensive README with examples
- ✅ Initializes lockfile for version tracking
- ✅ Optionally sets up git repository for workflows
- ✅ Beautiful Rich UI with summary table
- ✅ Helpful next steps guidance
- ✅ Smart duplicate detection with prompt

## 🐛 Bug Fixes

### Fixed Path Resolution for New Installations

**Problem:** New installations were creating `.mcli/commands/` instead of `.mcli/workflows/`

**Root Cause:** The `get_local_commands_dir()` function in `paths.py` was always returning the old `commands` path when neither directory existed, instead of prioritizing the new `workflows` path for fresh installations.

**Solution:** Updated path resolution logic to:
1. Check if `workflows/` exists → return it
2. Check if `commands/` exists (migration support) → return it
3. Neither exists → return `workflows/` path (for new installations)

**Impact:** All new `mcli workflow` operations now correctly use `.mcli/workflows/` directory

## 🔧 Technical Changes

### Modified Files

**`src/mcli/app/commands_cmd.py`** (156 lines added)
- Added `init_workflows()` function as `@workflow.command("init")`
- Creates directory structure with README, lockfile, and .gitignore
- Supports `--global`, `--git`, and `--force` flags
- Rich UI with progress indicators and summary table

**`src/mcli/lib/paths.py`** (3 lines changed)
- Fixed `get_local_commands_dir()` to return `workflows_dir` for new installations
- Maintains backward compatibility for existing `commands/` directories

**`README.md`** (14 lines added)
- Added "Initialize Workflows Directory" section to Quick Start
- Documented the new `mcli workflow init` command
- Explained what files are created

## 📊 Statistics

- **Lines Added:** 170
- **Lines Removed:** 1
- **Files Modified:** 3
- **New Commands:** 1 (`mcli workflow init`)

## 🔄 Upgrade Instructions

### For Existing Users

```bash
# Upgrade via pip
pip install --upgrade mcli-framework

# Or with UV
uv pip install --upgrade mcli-framework

# Verify version
mcli version  # Should show 7.11.1
```

### For New Projects

```bash
# Install mcli
uv pip install mcli-framework

# Initialize workflows in your project
cd ~/my-project
git init  # if not already a git repo
mcli workflow init

# Start creating workflows
mcli workflow add my-first-workflow
```

## 📖 Usage Examples

### Initialize in a Git Repository

```bash
cd ~/my-app
mcli workflow init
```

**Output:**
```
✓ Created workflows directory: /Users/you/my-app/.mcli/workflows
✓ Created README: README.md
✓ Initialized lockfile: commands.lock.json
✓ Created .gitignore

Workflows directory initialized successfully!

┌─────────────────┬───────────────────────────────────────────┐
│ Scope           │ Local (repository-specific)              │
│ Location        │ /Users/you/my-app/.mcli/workflows        │
│ Git Repository  │ /Users/you/my-app                        │
│ Lockfile        │ .../commands.lock.json                   │
│ Git Initialized │ No                                        │
└─────────────────┴───────────────────────────────────────────┘

Next Steps:
  1. Create a workflow:  mcli workflow add my-workflow
  2. List workflows:     mcli workflow list --custom-only
  3. Execute workflow:   mcli workflows my-workflow
  4. View README:        cat .mcli/workflows/README.md
```

### Initialize with Git Tracking

```bash
cd ~/my-app
mcli workflow init --git
```

This creates a git repository inside `.mcli/workflows/` and makes an initial commit, allowing you to version control your workflows separately from your main project.

### Initialize Global Workflows

```bash
mcli workflow init --global
```

Creates `~/.mcli/workflows/` for user-wide workflows that work across all projects.

## 🔄 Backward Compatibility

- ✅ **Fully backward compatible**
- Existing `~/.mcli/commands/` directories continue to work
- Migration path preserved for users who haven't migrated yet
- No breaking changes to existing workflows

## 🔗 Links

- **PyPI Package:** https://pypi.org/project/mcli-framework/
- **GitHub Repository:** https://github.com/gwicho38/mcli
- **Documentation:** https://github.com/gwicho38/mcli/tree/main/docs
- **Previous Release:** [v7.11.0](./7.11.0.md)

## 🙏 Acknowledgments

This feature was added in response to user feedback requesting an easier way to set up workflows directories with proper configuration files.

---

**Full Changelog:** https://github.com/gwicho38/mcli-framework/compare/v7.11.0...v7.11.1
