# MCLI Framework 7.1.1 Release Notes

**Release Date**: October 6, 2025
**Type**: Patch Release (Bug Fix)

## ğŸ› Bug Fixes

### Critical: Fixed `mcli self update` for uv tool installations

**Issue**: Users who installed mcli via `uv tool install mcli-framework` encountered an error when running `mcli self update`:

```
âœ“ CI build is passing
ğŸ“¦ Installing mcli 7.1.0...
âŒ Update failed:
/Users/lefv/.local/share/uv/tools/mcli-framework/bin/python: No module named pip
```

**Root Cause**: The uv tool installation detection was not robust enough, causing the update command to fall back to using `python -m pip install` instead of `uv tool install`. UV tool environments don't include pip by default, resulting in the "No module named pip" error.

**Fix**:
- Improved uv tool detection with normalized path handling and multiple detection patterns
- Now correctly uses `uv tool install --force` for uv tool installations
- Falls back to `pip install` only for regular Python installations
- Added path normalization for cross-platform compatibility

**Files Changed**:
- `src/mcli/self/self_cmd.py` - Enhanced uv tool detection logic (lines 1275-1283)

**Tests Added**:
- `tests/unit/test_self_update.py` - 7 comprehensive tests including regression test
- All tests passing âœ…

### Other Fixes

#### Security Workflow Improvement
- **Fixed TruffleHog secret scanning** to use dynamic commit references
- Now uses `${{ github.event.before || 'main' }}` for incremental scanning
- Better performance and accuracy for secret detection in CI

#### Logs Command Enhancement
- **Added `--follow/-f` flag** to `mcli logs tail` command
- Works like traditional `tail -f` for continuous log monitoring
- Handles Ctrl+C gracefully with clean termination
- Usage: `mcli logs tail main -f` or `mcli logs tail trace --follow`

## ğŸ“Š Test Coverage

### New Tests Added
- **Prediction Engine**: 19 unit tests for `PoliticianTradingPredictor`
- **Dashboard Functions**: 6 unit tests for LSH jobs DataFrame bug fix
- **Logs Command**: 17 unit tests for tail command with follow mode
- **Self Update**: 7 unit tests for uv tool detection

**Total New Tests**: 49
**All Passing**: âœ…

## ğŸš€ Upgrade Instructions

### For uv tool users (RECOMMENDED):
```bash
uv tool install --force mcli-framework
```

### For pip users:
```bash
pip install --upgrade mcli-framework
```

### Using mcli self update (after installing 7.1.1):
```bash
mcli self update
```

This command now works correctly for both uv tool and pip installations!

## ğŸ“ Changes Since 7.1.0

### Features
- âœ… Add `--follow/-f` flag to `mcli logs tail` command (17 tests)
- âœ… Add real prediction engine for stock recommendations from politician trades
- âœ… Comprehensive prediction engine documentation

### Bug Fixes
- âœ… **Fix `mcli self update` for uv tool installations** (Critical - this release)
- âœ… Fix LSH jobs DataFrame returning None on Streamlit Cloud
- âœ… Fix TruffleHog secret scanning in GitHub Actions
- âœ… Fix deprecation warnings for asyncio-mqtt and use_container_width

### Tests & Quality
- âœ… 49 new comprehensive unit tests
- âœ… Test coverage for prediction engine, dashboard, logs, and self update
- âœ… Regression tests for critical bugs

## ğŸ”— Links

- **GitHub Release**: https://github.com/gwicho38/mcli/releases/tag/v7.1.1
- **PyPI Package**: https://pypi.org/project/mcli-framework/7.1.1/
- **Dashboard Demo**: https://web-mcli.streamlit.app/

## ğŸ“ˆ What's Next

Version 7.2.0 will focus on:
- Enhanced ML predictions with real stock price data
- Additional dashboard visualizations
- Performance optimizations for large datasets

## ğŸ™ Acknowledgments

Thanks to all users who reported issues and helped test the fixes!

---

**Full Changelog**: https://github.com/gwicho38/mcli/compare/v7.1.0...v7.1.1
