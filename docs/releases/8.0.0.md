# Release Notes - Version 8.0.0

**Release Date:** 2025-12-22

## Overview

Version 8.0.0 is a major release that simplifies the mcli command structure, focusing on the core "command runner" experience. The CLI has been restructured with intuitive top-level commands while maintaining backward compatibility.

## Breaking Changes

### Simplified Command Structure

The CLI has been reorganized to be more intuitive:

| Old Command | New Command | Notes |
|-------------|-------------|-------|
| `mcli workflow list` | `mcli list` | Promoted to top-level |
| `mcli workflow search` | `mcli search` | Promoted to top-level |
| `mcli workflow remove` | `mcli delete` (or `rm`) | Promoted to top-level |
| `mcli workflow edit` | `mcli edit` | Promoted to top-level |
| `mcli lock status` | `mcli sync status` | Merged into sync |
| `mcli lock update` | `mcli sync update` | Merged into sync |
| `mcli lock diff` | `mcli sync diff` | Merged into sync |
| `mcli workflow store *` | `mcli config store *` | Moved under config |

### Removed Commands

- `mcli lock` group - Functionality merged into `mcli sync`
- `mcli workflow` management group - Commands promoted to top-level

## New Features

### Workspace Support for `mcli run`

**Description:** Execute workflows from any workspace directory.

The `mcli run` command now supports a `-f/--workspace` flag to run workflows from a specific directory or config file:

```bash
# Run workflow from specific workspace
mcli run -f ~/projects/myapp my-workflow

# Run from a config file (auto-detects workflows_dir)
mcli run -f ~/projects/myapp/mcli.toml my-workflow

# The flag is mutually exclusive with -g/--global
mcli run -g my-workflow    # Global workflows
mcli run -f /path my-workflow  # Workspace workflows
```

**Supported config formats:**
- Directory paths (uses `<dir>/.mcli/workflows/`)
- JSON config files (reads `workflows_dir` key)
- TOML config files (reads `workflows_dir` key)
- YAML config files (reads `workflows_dir` key)

### Unified Sync Command

**Description:** Combined IPFS sync and lockfile management.

The `mcli sync` command now handles both IPFS synchronization and lockfile management:

**Lockfile Management:**
```bash
mcli sync status    # Show workflow scripts and lockfile status
mcli sync update    # Update lockfile with current script state
mcli sync diff      # Show differences between scripts and lockfile
mcli sync show      # Show lockfile contents
```

**IPFS Sync:**
```bash
mcli sync push      # Upload workflow state to IPFS
mcli sync pull <cid>  # Download workflow state from IPFS
mcli sync verify <cid>  # Verify CID accessibility
mcli sync history   # Show IPFS sync history
```

### Config Command Group

**Description:** Centralized configuration management.

New `mcli config` group for all configuration-related operations:

```bash
# Workflow directory management
mcli config init          # Initialize workflows directory
mcli config teardown      # Remove workflows directory
mcli config show          # Show current configuration

# Git-based workflow store
mcli config store init    # Initialize git store
mcli config store push    # Push workflows to git remote
mcli config store pull    # Pull workflows from git remote
mcli config store status  # Show store status
```

### Top-Level Command Shortcuts

**Description:** Common operations promoted to top-level.

```bash
mcli init              # Initialize workflows directory
mcli list              # List available workflow commands
mcli search <query>    # Search commands by name/description
mcli new <name>        # Create new workflow command
mcli edit <name>       # Edit command in $EDITOR
mcli delete <name>     # Delete a command (alias: rm)
```

## Technical Changes

### Files Added
- `src/mcli/app/list_cmd.py` - List command
- `src/mcli/app/search_cmd.py` - Search command
- `src/mcli/app/delete_cmd.py` - Delete command with rm alias
- `src/mcli/app/config_cmd.py` - Config group with store subgroup

### Files Modified
- `src/mcli/app/main.py` - Register new top-level commands
- `src/mcli/app/sync_cmd.py` - Merged lockfile management
- `src/mcli/workflow/workflow.py` - Added workspace support
- `src/mcli/lib/paths.py` - Added `resolve_workspace()` function

### Files Removed
- `src/mcli/app/lock_cmd.py` - Merged into sync_cmd.py

## Upgrade Guide

1. **Update your scripts:**
   - Replace `mcli workflow list` with `mcli list`
   - Replace `mcli workflow search` with `mcli search`
   - Replace `mcli workflow remove` with `mcli delete` or `mcli rm`
   - Replace `mcli lock *` with `mcli sync *`

2. **Store commands:**
   - Replace `mcli workflow store init` with `mcli config store init`
   - Other store commands follow the same pattern

3. **Run commands unchanged:**
   - `mcli run` and `mcli workflows` continue to work as before
   - The new `-f/--workspace` flag is optional

## Backward Compatibility

The following aliases are maintained for backward compatibility:
- `mcli workflows` → `mcli run`
- `mcli rm` → `mcli delete`
