# MCLI Framework 7.0.6 Release Notes

**Release Date:** October 2, 2025
**Previous Version:** 7.0.5

## Bug Fixes

### Fixed `mcli self update` for uv Tool Installations

**Issue:** The `mcli self update` command failed with error "No module named pip" when installed via `uv tool install`.

**Root Cause:** The update command was using `pip install --upgrade` which doesn't work in uv tool environments because uv creates isolated Python environments without pip.

**Fix:** Updated the update command to:
1. Detect if running from a uv tool installation (checks if `sys.executable` contains `.local/share/uv/tools/`)
2. Use `uv tool install --force mcli-framework` for uv tool environments
3. Use `pip install --upgrade mcli-framework` for regular Python installations

**Files Changed:**
- `src/mcli/self/self_cmd.py` - Added uv tool detection and appropriate installation method (lines 1275-1304)
- `tests/test_self.py` - Added 2 new tests for uv tool and pip installation paths

**Testing:**
- ✅ Added `test_update_uses_uv_tool_when_detected()` - Verifies uv tool install is used in uv environments
- ✅ Added `test_update_uses_pip_when_not_uv_tool()` - Verifies pip is used in regular Python environments
- ✅ All 24 tests in test_self.py passing

## Changes Summary

### Modified Files

#### `src/mcli/self/self_cmd.py`
```diff
+ # Detect if we're running from a uv tool installation
+ # uv tool installations are typically in ~/.local/share/uv/tools/
+ is_uv_tool = ".local/share/uv/tools/" in sys.executable or \
+              "\\AppData\\Local\\uv\\tools\\" in sys.executable
+
+ if is_uv_tool:
+     # Use uv tool install for uv tool environments
+     console.print("[dim]Detected uv tool installation, using 'uv tool install'[/dim]")
+     cmd = ["uv", "tool", "install", "--force", "mcli-framework"]
+ else:
+     # Use pip to upgrade for regular installations
+     cmd = [sys.executable, "-m", "pip", "install", "--upgrade", "mcli-framework"]
```

#### `tests/test_self.py`
- Added `test_update_uses_uv_tool_when_detected()` test
- Added `test_update_uses_pip_when_not_uv_tool()` test
- Now 24 total tests (was 22)

## Upgrade Instructions

### Via uv (Recommended)
```bash
uv tool install mcli-framework --force
```

### Via pip
```bash
pip install --upgrade mcli-framework
```

### Via mcli self-update (Now Fixed!)
```bash
mcli self update
```

## Verification

After upgrading, verify the fix:
```bash
# Check version
mcli --version
# Should show: 7.0.6

# Test update command
mcli self update --check
# Should work without "No module named pip" error
```

## Installation Methods

All installation methods now support version 7.0.6:

1. **PyPI** - `uv tool install mcli-framework` (recommended)
2. **GitHub** - `uv tool install git+https://github.com/gwicho38/mcli.git`
3. **Homebrew** - `brew tap gwicho38/mcli && brew install mcli` (experimental)

## Known Issues

None in this release.

## Contributors

- Luis Fernandez de la Vara

## Links

- [GitHub Repository](https://github.com/gwicho38/mcli)
- [PyPI Package](https://pypi.org/project/mcli-framework/)
- [Issue Tracker](https://github.com/gwicho38/mcli/issues)
