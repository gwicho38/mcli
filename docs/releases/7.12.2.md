# Release Notes: v7.12.2

**Release Date:** 2025-11-01

## üêõ Bug Fixes & Enhancements

### Workflow Code Validation

Enhanced the `mcli lock verify` command with code validation capabilities to help diagnose workflow loading issues.

#### Changes

**New `--code` Flag for Verification**

The `mcli lock verify` command now supports an optional `--code` flag to validate that workflow code is syntactically correct and properly defines Click commands.

**Before:**
```bash
mcli lock verify                # Only verifies lockfile matches
```

**Now:**
```bash
mcli lock verify                # Verifies lockfile matches
mcli lock verify --code         # Also validates workflow code
mcli lock verify -c             # Short form
```

#### What It Validates

When using `--code`, the verification checks:

1. **Syntax Errors**: Ensures workflow Python code has no syntax errors
2. **Click Command Definition**: Validates code defines a proper `@click.command()` decorated function
3. **Code Execution**: Confirms the workflow code can be loaded and executed
4. **Detailed Error Reporting**: Shows specific reasons why workflows fail to load

#### Example Output

**Valid Workflows:**
```bash
$ mcli lock verify --code
Validating workflow code...

‚úì All workflow code is valid

‚úì All custom commands are verified
```

**Invalid Workflows:**
```bash
$ mcli lock verify --code
Validating workflow code...

Invalid workflows found:

  ‚úó politician_trading_tracker
    Code does not define a valid Click command

Fix with: mcli workflow edit <workflow-name>
Tip: Workflow code must define a Click command decorated with @click.command()
```

#### Use Case

This feature is particularly useful when workflows aren't appearing in `mcli workflows` output. Running `mcli lock verify --code` helps identify:
- Workflows with only commented-out example code
- Workflows with syntax errors
- Workflows missing Click command decorators
- Workflows that fail to load for other reasons

### Files Modified

- `src/mcli/app/lock_cmd.py` - Added `--code` flag and validation logic to `verify_commands`

### Testing

- ‚úÖ `mcli lock verify` works without `--code` flag (backward compatible)
- ‚úÖ `mcli lock verify --code` validates workflow code
- ‚úÖ `mcli lock verify -c` short form works
- ‚úÖ Correctly identifies invalid workflows
- ‚úÖ Correctly validates valid workflows
- ‚úÖ Provides helpful error messages for debugging

### Breaking Changes

None - this is a backward-compatible enhancement.

### Migration

No migration required. The `--code` flag is optional.

---

**Full Changelog**: https://github.com/gwicho38/mcli/compare/v7.12.1...v7.12.2
