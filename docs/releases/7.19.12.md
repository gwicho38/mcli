# Release 7.19.12

**Release Date:** 2025-11-29

## Summary

This release fixes a critical bug in `mcli new` where user code written in the template was being discarded.

## Bug Fixes

### Command Creation (`mcli new`)
- **Fixed:** User code written in the template before the `# Your command implementation goes here:` marker was being discarded
- The extraction logic now properly preserves all user code, only removing the instruction docstring at the top
- Added comprehensive tests for the code extraction logic

## Technical Details

The previous extraction logic only kept code that appeared **after** the marker comment `# Your command implementation goes here:`. This meant that if users wrote their code in the natural location (in the template section), their code would be lost and only the commented examples at the end would be saved.

The new logic:
1. Removes only the instruction docstring (contains "Instructions:" or "Example Click command")
2. If users write code before the marker, that code is preserved
3. If users write meaningful code after the marker, all code is kept
4. Normal module docstrings (without instruction markers) are preserved

## Files Changed

- `src/mcli/app/new_cmd.py` - Fixed code extraction logic in `open_editor_for_command()`
- `tests/unit/test_new_cmd.py` - Added 6 tests covering the extraction logic

## Testing

- All 830 tests pass (824 fast + 6 new)
- Specific test coverage for:
  - Instruction docstring removal
  - User code before marker preservation
  - User code after marker preservation
  - Normal docstring preservation
  - Code without markers
  - Empty code handling

## Migration Notes

No action required. This is a bug fix that improves behavior.

---

**Full Changelog:** https://github.com/gwicho38/mcli/compare/v7.19.11...v7.19.12
