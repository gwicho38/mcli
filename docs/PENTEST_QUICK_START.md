# MCLI Pentest Workflow - Quick Start Guide

## ðŸš€ 5-Minute Getting Started

### Installation

```bash
# Dependencies are already installed if you're using this guide
# The command is at: ~/.mcli/commands/pentest.json
```

### Your First Pen Test

```bash
# 1. List available templates
mcli workflow pentest list-templates

# 2. Generate a test script
mcli workflow pentest generate-test \
  -t csrf \
  -u https://example.com/form \
  -o my_first_test.sh

# 3. Review the script
cat my_first_test.sh

# 4. Generate a report
mcli workflow pentest report \
  --template csrf \
  --title "My First Vulnerability Report" \
  --severity medium
```

## ðŸŽ¯ Common Tasks

### Test for CSRF Vulnerability

```bash
mcli workflow pentest generate-test -t csrf -u YOUR_TARGET_URL
```

### Test for Referrer Header Leakage

```bash
mcli workflow pentest generate-test -t referrer-leak -u YOUR_TARGET_URL
```

### Generate HackerOne Report

```bash
mcli workflow pentest report \
  --template csrf \
  --title "CSRF in Login Form" \
  --severity high \
  --program "Target Program"
```

### Complete Workflow (All-in-One)

```bash
mcli workflow pentest workflow \
  https://hackerone.com/program \
  --vuln-type csrf
```

## ðŸ“‹ Vulnerability Types

| Type | Description | Command Flag |
|------|-------------|--------------|
| CSRF | Cross-Site Request Forgery | `csrf` |
| XSS | Cross-Site Scripting | `xss` |
| Referrer Leak | Session token leakage | `referrer-leak` |
| SQL Injection | Database attacks | `sql-injection` |
| Auth Bypass | Authentication issues | `auth-bypass` |

## ðŸ”§ Based on Your Research

### Google Forms CSRF Testing

From your CSRF PoC scripts:

```bash
# Generate test
mcli workflow pentest generate-test \
  -t csrf \
  -u "https://docs.google.com/forms/d/e/FORM_ID/viewform"

# Generate report
mcli workflow pentest report \
  --template csrf \
  --title "CSRF Vulnerability in Google Forms Integration" \
  --severity medium
```

### Referrer Header Leakage

From your referrer leakage research:

```bash
# Generate test
mcli workflow pentest generate-test \
  -t referrer-leak \
  -u "https://hackerone.com/redirect"

# Generate report
mcli workflow pentest report \
  --template referrer-leak \
  --title "Session Token Exposure via Referrer Headers" \
  --severity high
```

## ðŸ“„ Output Files

All generated files go to `/tmp/` by default:

```
/tmp/csrf_test_TIMESTAMP.sh           # Test script
/tmp/hackerone_report_TITLE_DATE.md   # Report
/tmp/pentest_analysis.json            # Scope analysis
```

## âš ï¸ Important Reminders

1. âœ… **Get Authorization** - Only test authorized targets
2. âœ… **Read Scope** - Review program guidelines
3. âœ… **Test Responsibly** - No destructive actions
4. âœ… **Document Everything** - Keep detailed notes
5. âœ… **Report Properly** - Use official channels

## ðŸ” Next Steps

- Read full documentation: `docs/PENTEST_WORKFLOW.md`
- Customize templates: `mcli commands edit pentest`
- View command help: `mcli workflow pentest --help`

## ðŸ’¡ Pro Tips

### Tip 1: Save Your Workflow
```bash
# Create alias for common tasks
alias h1-csrf="mcli workflow pentest generate-test -t csrf -u"
alias h1-report="mcli workflow pentest report --template csrf"

# Usage
h1-csrf https://example.com/form
h1-report --title "Found CSRF" --severity high
```

### Tip 2: Batch Testing
```bash
# Test multiple vulnerability types
for vuln in csrf xss referrer-leak; do
  mcli workflow pentest generate-test -t $vuln -u https://example.com
done
```

### Tip 3: Integration with Your Scripts
```bash
# Run generated test and capture output
bash csrf_test.sh > results.txt 2>&1

# Include in report
mcli workflow pentest report \
  --title "CSRF Vulnerability" \
  --template csrf
```

## ðŸ“ž Support

- Command info: `mcli commands info pentest`
- List templates: `mcli workflow pentest list-templates`
- Help: `mcli workflow pentest COMMAND --help`

---

**Ready to start bug hunting? Pick a target, generate a test, and create your first report!** ðŸŽ¯
